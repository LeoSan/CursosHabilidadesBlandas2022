# Curso de Excel Avanzado con Macros üöÄ

> Automatiza tareas avanzadas en Excel con el poder de las macros y Visual Basic. Desde crear funciones y subrutinas hasta utilizar ciclos y condicionales, optimiza tus hojas de c√°lculo y multiplica tu productividad.

| Detalle | Informaci√≥n |
| :--- | :--- |
| **Publicado el** | Publicado el 19 de octubre de 2022 |
| **Profesor** | Annie Parente Dodero |
| **Fecha de Inicio** | 06/11/2025 |
| **Fecha de Fin** |  |

## CLASE 01: Macros y Visual Basic en Excel Avanzado

**¬øQu√© son las macros y c√≥mo pueden revolucionar tu uso de Excel?**

Las macros son secuencias de acciones automatizadas que puedes ejecutar tantas veces como lo necesites. ¬øTe imaginas tener que dar el mismo formato, eliminar columnas, o agregar f√≥rmulas repetidamente cada d√≠a? Con macros, estas tareas repetitivas se automatizan, acelerando significativamente tu productividad y reduciendo los errores humanos.


- Aprender macros: una inversi√≥n de tiempo que transforma tu d√≠a a d√≠a
- Ahorro de tiempo: Al automatizar tareas tediosas, los profesionales pueden enfocarse en an√°lisis m√°s complejos y decisiones estrat√©gicas.
- Reducci√≥n de errores: Al realizar tareas autom√°ticamente, la probabilidad de errores humanos disminuye.
- Consistencia: Garantiza que las tareas se realicen del mismo modo cada vez, manteniendo la calidad y el formato del trabajo.


**¬øQu√© es Visual Basic for Applications (VBA) y por qu√© es fundamental?**

Visual Basic for Applications (VBA) es el lenguaje de programaci√≥n utilizado por Microsoft para personalizar y automatizar tareas en sus aplicaciones, incluyendo Excel. Es mediante este entorno que se pueden crear macros, subrutinas y funciones, personalizando Excel m√°s all√° de sus capacidades por defecto.

- Conociendo el entorno VBA: ¬øC√≥mo empezar?
- Grabaci√≥n de macros: Permite capturar secuencias de acciones exactas en Excel sin necesidad de conocer c√≥digo.
- Creaci√≥n desde cero: Programar desde cero permite personalizar hasta el m√°s m√≠nimo detalle.
- Subrutinas y funciones: Con el conocimiento de VBA, se pueden crear potentes subrutinas (secuencias de comandos que ejecutan tareas espec√≠ficas) y funciones para manipular y analizar datos de maneras m√°s sofisticadas.



## CLASE 02: 


## CLASE 03: 


## CLASE 04: 


## CLASE 05: 


## CLASE 06: Automatizaci√≥n de Tareas con Macros en Excel


**¬øQu√© es grabar y correr macros en Excel?**
Grabar macros en Excel es una manera efectiva de automatizar tareas repetitivas, ahorrando tiempo y esfuerzo considerable. Al grabar una macro, registras una secuencia de acciones que posteriormente puedes repetir con un simple comando. Esto es especialmente √∫til para tareas como descargar archivos regularmente y darles un formato, realizar operaciones matem√°ticas, o modificar celdas y columnas.

**¬øC√≥mo iniciar con las macros?**
Para empezar a trabajar con macros, necesitas un documento de Excel que est√© habilitado para macros (.xslm). Este formato permite que tus macros se ejecuten correctamente. Al abrir el documento, aseg√∫rate de que el formato es amigable y c√≥modo para trabajar. Si trabajar√°s frecuentemente con este archivo, considera grabar una macro para facilitar el proceso de formateo.

**¬øC√≥mo grabar una macro?**
Sigue estos pasos para grabar una macro en Excel:

Duplicar la hoja: Antes de comenzar, haz una copia de tu hoja de trabajo. Esto te permitir√° mantener la informaci√≥n original e intentar nuevamente si es necesario.
Acceder a la ficha Programador: Dir√≠gete al men√∫ 'Inicio' y selecciona 'Programador'. Aqu√≠ encontrar√°s el bot√≥n 'Grabar Macro'.
Asignar nombre y atajo: Al darle clic a 'Grabar Macro', se abrir√° una ventana para que asignes un nombre, como "Formato". Puedes tambi√©n establecer un atajo para ejecutar la macro r√°pidamente.
Elegir d√≥nde guardar: Decide el libro donde se guardar√° tu macro. Es recomendable elegir el mismo libro en el que est√°s trabajando.
Descripci√≥n de la macro: Aseg√∫rate de a√±adir una descripci√≥n corta explicando la funci√≥n de la macro. Esto es √∫til si deseas compartir o referenciar la macro m√°s adelante.
Realizar acciones: Comienza a realizar las acciones que deseas automatizar. Por ejemplo, ajustar el ancho de las columnas, aplicar negritas a los encabezados, centrar texto, y ocultar informaci√≥n innecesaria.
Finalizar grabaci√≥n: Una vez finalizadas las acciones, selecciona la celda final, ve a la ficha 'Programador' y selecciona 'Detener Grabaci√≥n'.


**PRIMERO HABILITAMOS LA PESTA√ëA DE PROGRAMDOR**
- PASO 1: ![alt text](image.png)

- PASO 2: ![alt text](image-1.png)

**segundo iniciamos esta macro para tareas repetitivas**
- PASO 1: ![alt text](image-2.png)-

- PASO 2: Lo curioso de las macros es podemos hacer nuestra actividad normal de manera cotidiana pegar, mover, crear celda cambiar formato etc y luego guardarla para luego ejecutarla en una hoja 

- PASO 3: ![alt text](image-3.png)

**PRACTICA**

**GENERO Y VALIDO FORMULAS**
=IZQUIERDA(FC[-1], HALLAR(" ", FC[-1], HALLAR(":", FC[-1])-3)-1)
> 11 de noviembre de 2025 

=SUSTITUIR(IZQUIERDA(FC[-1], HALLAR(" ", FC[-1], HALLAR(":", FC[-1])-3)-1), " de ", " ")
> 11 noviembre 2025
=FECHANUMERO(SUSTITUIR(IZQUIERDA(FC[-1], HALLAR(" ", FC[-1], HALLAR(":", FC[-1])-3)-1), " de ", " "))
> 45972
=TEXTO(FECHANUMERO(SUSTITUIR(IZQUIERDA(FC[-1], HALLAR(" ", FC[-1], HALLAR(":", FC[-1])-3)-1), " de ", " ")), "dd/mm/yyyy")

**BUSCAR LIBRO ORIGINAL**
- C:\Users\GlenaCDNP-Leonard\AppData\Roaming\Microsoft\Excel\XLSTART
> AQUI ES DONDE SE GUARDAN TODAS LAS MACROS QUE SE GENERA SOLO SI LAS GUARDAS EN LIBRO PERSONAL AUNQUE LA PUEDES GUARDAR EN UN EXCEL PARTICULAR PERO SOLO SE VE EN ESE EXCEL ES MEJOR GUARDARLO EN EL SISTEMA 


**GENERALMENTE ESTA BLOQUEADO**
> VISTA > MOSTRAR TODO 



```BD
**C√ìDIGO DE LA MACRO** 

Sub FORMATO_CELDA_FECHA_NUBE_V1()
'
' FORMATO_CELDA_FECHA_NUBE_V1 Macro
' FORMATO_CELDA_FECHA_NUBE_V1
'

'
    Rows("1:5").Select
    Selection.Delete Shift:=xlUp
    Columns("B:B").Select
    Columns("B:B").EntireColumn.AutoFit
    Columns("C:C").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("C2").Select
    ActiveCell.FormulaR1C1 = _
        "=DATEVALUE(SUBSTITUTE(LEFT(RC[-1], SEARCH("" "", RC[-1], SEARCH("":"", RC[-1])-3)-1), "" de "", "" ""))"
    Range("C2").Select
    Selection.AutoFill Destination:=Range("C2:C751")
    Range("C2:C751").Select
    Columns("C:C").Select
    Selection.NumberFormat = "m/d/yyyy"
    Range("C2").Select
    ''' SELECCIONA Y ELIMINA
    Columns("Z:BM").Select
    Selection.Delete Shift:=xlToLeft

End Sub
```



## CLASE 07:  Sintaxis de Funciones y Subrutinas en Visual Basic

**¬øCu√°l es la diferencia entre funciones y subrutinas en VBA?**
- Las funciones y subrutinas son dos elementos fundamentales en VBA que sirven prop√≥sitos distintos:
- Las funciones est√°n dise√±adas para realizar c√°lculos y devolver un resultado espec√≠fico
- Las subrutinas ejecutan acciones en el documento sin necesidad de retornar valores

**¬øC√≥mo se define la accesibilidad de una funci√≥n o subrutina?**
- La accesibilidad determina desde d√≥nde se puede utilizar nuestro c√≥digo:

- Public: permite que la funci√≥n sea accesible desde cualquier m√≥dulo del documento
- Private: restringe el uso de la funci√≥n al m√≥dulo donde fue creada
- Si no se especifica, por defecto ser√° p√∫blica

**¬øCu√°les son los elementos esenciales de la sintaxis?**
Para escribir correctamente una funci√≥n o subrutina, debemos incluir:

- Declaraci√≥n de accesibilidad (Public/Private)
- Tipo de procedimiento (Function/Sub)
- Nombre descriptivo que refleje su prop√≥sito
- Par√°metros necesarios entre par√©ntesis
- Tipo de dato que devolver√° (solo para funciones)
- Cierre con End Function o End Sub

**¬øQu√© buenas pr√°cticas debemos seguir al programar en VBA?**
- La claridad y organizaci√≥n del c√≥digo son esenciales para su mantenimiento:

**¬øC√≥mo nombrar nuestras funciones y subrutinas?**
- Usar nombres descriptivos que reflejen la acci√≥n o resultado
- Evitar nombres gen√©ricos o poco claros
- Mantener consistencia en el estilo de nombrado

**¬øC√≥mo estructurar el c√≥digo visualmente?**
- Utilizar la tecla Tab para crear sangr√≠as l√≥gicas
- Separar bloques de c√≥digo relacionados
- Mantener un formato consistente en todo el proyecto



## CLASE 08:  Creaci√≥n de Funciones en Visual Basic para Excel

**¬øC√≥mo crear una funci√≥n en Visual Basic?**

Crear una funci√≥n en Visual Basic es un proceso met√≥dico que empieza por la definici√≥n de un problema que necesitas resolver. Por ejemplo, calcular un a√±o despu√©s de agregar un n√∫mero fijo al a√±o actual.

**¬øCu√°les son los pasos para definir una funci√≥n b√°sica?**

Definir la funci√≥n y sus par√°metros: Declara una funci√≥n p√∫blica en tu m√≥dulo que contemple un n√∫mero entero como atributo de entrada y que devuelva un n√∫mero entero.
Definir la operaci√≥n: Realiza la operaci√≥n deseada, como sumar un valor fijo al atributo de entrada.
Asegurar la correcci√≥n t√©cnica: Comprueba que la funci√≥n est√° correctamente configurada. Visual Basic proporciona se√±ales visuales para posibles errores, como el subrayado en rojo.
Guardar el resultado: El resultado de la operaci√≥n debe ser asignado al nombre de la funci√≥n para retornar el valor esperado.

**¬øC√≥mo se puede probar la funci√≥n?**
Para verificar la funcionalidad correcta de tu funci√≥n dentro de Visual Basic, usa la ventana "Inmediato" (disponible en el men√∫ "Ver"). All√≠:

Utiliza un signo de interrogaci√≥n seguido del nombre de tu funci√≥n.
Introduce un valor num√©rico que se ajusta al tipo de dato esperado.
Presiona Enter para ver el resultado calculado.
Este m√©todo es inmediato para verificar la funci√≥n con diferentes par√°metros, asegurando su correcto funcionamiento.

**¬øC√≥mo usar la funci√≥n en Excel?**
Una vez definida en Visual Basic, la funci√≥n personalizada puede ser integrada en Excel. Esto te permite ampliar el potencial de tus hojas de c√°lculo al utilizar operaciones espec√≠ficas no disponibles en las funciones est√°ndar de Excel.

Implementar la funci√≥n: Escribe igual ( = ) y el nombre de tu funci√≥n en una celda de Excel, selecciona o ingresa el par√°metro adecuado.
Verificaci√≥n del resultado: Excel devolver√° el c√°lculo basado en la l√≥gica definida en Visual Basic, tal como lo ver√≠as en el entorno de desarrollo.

**¬øQu√© hacer en caso de ingresar datos incorrectos?**
Visual Basic maneja los errores redondeando valores err√≥neos al tipo esperado. Por ejemplo, si ingresas un decimal cuando se espera un entero, este se redondear√° autom√°ticamente. Esto garantiza que las funciones permanezcan robustas ante entradas inesperadas.

**¬øCu√°l es el siguiente paso en el aprendizaje de Visual Basic?**
Te animamos a aplicar lo aprendido creando una funci√≥n propia, como calcular el cuadrado de un n√∫mero. Este ejercicio te ayudar√° a familiarizarte m√°s con la sintaxis y l√≥gica del lenguaje. ¬°Comparte tus resultados para seguir mejorando y compartir tus avances! Con pr√°ctica continua, te volver√°s cada vez m√°s competente y eficiente en el uso de Visual Basic.

**PRACTICA**
![alt text](image-4.png)

![alt text](image-5.png)

```VB

Public Function calculaSuma(valor1 As Integer, valor2 As Integer) As Integer
    calculaSuma = valor1 + valor2
End Function


Public Function calculaResta(valor1 As Integer, valor2 As Integer) As Integer
    calculaResta = valor1 - valor2
End Function

Public Function calculaMulti(valor1 As Integer, valor2 As Integer) As Integer
    calculaMulti = valor1 * valor2
End Function

Public Function calculaDivision(valor1 As Integer, valor2 As Integer) As Integer
    If valor2 > 0 Then
        calculaDivision = valor1 / valor2
    Else
        calculaDivision = 0
    End If
End Function



?calculaSuma(10,10)
 20 
?calculaResta(100,30)
 70 
 ?calculaDivision(2,0) 
 0 

```
## CLASE 09:  Creaci√≥n de Subrutinas en Visual Basic para Excel

**¬øC√≥mo se crea una subrutina en Visual Basic para Excel?**

El manejo de subrutinas en Visual Basic para Excel es una habilidad que diferencia a un usuario casual de uno avanzado. Las subrutinas permiten automatizar tareas repetitivas y mejorar la eficiencia en la gesti√≥n de datos. En esta gu√≠a, aprender√°s a crear tu primera subrutina y a entender las bases que te permitir√°n expandir tus habilidades en programaci√≥n dentro del ecosistema de Excel.

**¬øQu√© es una subrutina y c√≥mo se diferencia de una funci√≥n?**

Una subrutina es un bloque de c√≥digo que ejecuta una serie de instrucciones en Excel sin devolver un resultado directo, a diferencia de las funciones que s√≠ lo hacen. En su lugar, el impacto de una subrutina se ve reflejado en las acciones que realiza, tales como manipular celdas, hojas o rangos dentro del libro de Excel.

Ventajas de las Subrutinas:
No consumen recursos devolviendo un resultado innecesario.
Son ideales para tareas autom√°ticas y procedimientos de manejo de datos dentro del documento.

**¬øC√≥mo iniciar un archivo para trabajar con subrutinas?**
Para empezar a trabajar con subrutinas, necesitas abrir un archivo de Excel habilitado para macros. Esto es crucial para asegurarse de que todo el trabajo quede guardado y pueda ser ejecutado sin problemas futuros. En el entorno de Visual Basic, las subrutinas se encuentran dentro de m√≥dulos, donde puedes organizarlas seg√∫n tus necesidades.

Consejos para la organizaci√≥n de m√≥dulos:
Uso de Comentarios: Incluir comentarios en tu c√≥digo es una buena pr√°ctica que te ayudar√° a documentar lo que hace cada segmento de tu programaci√≥n, facilitando la comprensi√≥n futura del c√≥digo.
Modularizaci√≥n: Crear varios m√≥dulos si la carga de subrutinas y funciones lo justifica, as√≠ mejorar√°s el orden y legibilidad del c√≥digo.


**¬øC√≥mo redactar una subrutina b√°sica?**
Para comenzar a escribir una subrutina, lo primero es definir si ser√° p√∫blica o privada. Las subrutinas p√∫blicas pueden ser llamadas desde diferentes lugares del proyecto, mientras que las privadas est√°n limitadas al m√≥dulo donde se encuentran.
```VB
Public Sub prueba2()
    ' Subrutina b√°sica sin argumentos.
End Sub
```

**¬øC√≥mo trabajar con celdas y rangos en subrutinas?**
Una de las tareas fundamentales de las subrutinas es la manipulaci√≥n de celdas y rangos. Esto implica hacer referencia a celdas espec√≠ficas, manipular rangos de datos o realizar c√°lculos dentro del libro.

Referenciar una Celda:
```VB
Cells(1, 1).Value = "Hola, mundo"
Manipular un Rango:

Range("B2:C3").Value = "Platzi es lo mejor"
```
Es importante recordar que los nombres de celdas en Visual Basic usan un formato num√©rico, donde las filas y columnas tienen n√∫meros asociados.

**¬øC√≥mo especificar la hoja en la que se ejecutar√° la subrutina?**
En muchas ocasiones, necesitar√°s que las acciones de la subrutina se ejecuten en hojas espec√≠ficas, especialmente cuando trabajas con documentos de Excel que contienen m√∫ltiples hojas.

Seleccionar una hoja espec√≠fica:
Sheets("Hoja2").Select
Este ejemplo asegura que la subrutina se ejecute en la hoja "Hoja2", incluso si est√°s visualizando otra hoja al momento de ejecutar el c√≥digo.

**¬øC√≥mo ejecutar y probar una subrutina?**
Finalmente, una parte esencial del desarrollo de subrutinas es la validaci√≥n y ejecuci√≥n del c√≥digo. Puedes correr tu subrutina desde el entorno de Visual Basic utilizando el bot√≥n de "Correr" o mediante la tecla F5.

Al finalizar estos pasos, deber√≠as tener una comprensi√≥n b√°sica y la habilidad para crear subrutinas efectivas en Visual Basic para Excel. Te invito a que pruebes lo aprendido, experimentando y perfeccionando estas t√©cnicas. Expande tus conocimientos y comparte tus resultados para seguir aprendiendo. ¬°El mundo de la programaci√≥n en Excel te espera!


**PRACTICA**
```VB
'GENERACI√ìN DE SUBRUTINAS'

Public Sub tareaSub()
    Sheets("Hoja1").Select
    Cells(1, 1) = "Hola mundo"
    Range(Cells(2, 6), Cells(3, 6)) = "Hola mundo con un rango de (2,3)(3,6)"
    Range("A3:A6") = "Excel"
End Sub

```
## CLASE 10: Uso de MessageBox en Visual Basic para Mostrar Resultados

**¬øC√≥mo implementar message box en Visual Basic?**
> La implementaci√≥n de message box en Visual Basic requiere una estructura espec√≠fica que permite mostrar mensajes personalizados al usuario. El proceso comienza con la creaci√≥n de una funci√≥n b√°sica:

- Definir una funci√≥n p√∫blica
- Establecer los argumentos necesarios
- Implementar la l√≥gica de la funci√≥n
- Agregar el message box

**¬øCu√°l es la sintaxis correcta para crear un message box?**
Para implementar un message box efectivo, es necesario seguir estos pasos:

- Declarar una variable utilizando "dim"
- Asignar el message box a la variable declarada
- Utilizar la estructura: MsgBox(prompt, buttons, title)
- El prompt es el mensaje principal, buttons define el tipo de botones a mostrar, y title establece el encabezado de la ventana emergente.

**¬øC√≥mo personalizar el contenido del message box?**
La personalizaci√≥n del message box permite crear mensajes m√°s informativos y profesionales:

- Combinar texto y variables utilizando el operador ampersand (&)
- Seleccionar diferentes tipos de botones seg√∫n la necesidad
- Agregar t√≠tulos descriptivos para contextualizar el mensaje
- Incluir informaci√≥n din√°mica basada en los resultados de la funci√≥n

**¬øCu√°les son las aplicaciones pr√°cticas del message box?**
El message box es una herramienta vers√°til que puede utilizarse en diversos escenarios:

- Mostrar resultados de operaciones matem√°ticas
- Presentar mensajes de error
- Proporcionar informaci√≥n de estado
- Solicitar confirmaci√≥n del usuario

```VB
Public Function calculaDivision(Numerador As Integer, Denominador As Integer) As Double
    Dim a
    Sheets("Hoja1").Select
    If Denominador > 0 Then
        calculaDivision = Numerador / Denominador
    Else
        a = MsgBox("El resultado de la division no puede ser cero", , "Division")
    End If
End Function
```

## CLASE 11:  Input Box en Visual Basic: Solicitar Datos al Usuario

**¬øQu√© es un Input Box y c√≥mo se utiliza?**
Un Input Box es una ventana emergente que permite solicitar al usuario que ingrese un valor o dato espec√≠fico.

Para implementarlo:

Se recomienda definir una variable para almacenar el valor que el usuario proporcionar√°.
Esta variable debe declararse utilizando Dim seguido del nombre de la variable y su tipo de dato, como por ejemplo, Dim numerador As Integer.
Se emplea la funci√≥n InputBox, que abre la caja de texto emergente.
Ejemplo de sintaxis b√°sica:

Dim numerador As Integer
numerador = InputBox("Escribe el numerador", "Divisi√≥n")

**¬øC√≥mo alojamos el resultado de un Input Box?**
Es crucial almacenar el dato ingresado por el usuario en una variable adecuada.

Antes de la llamada a InputBox, declaramos nuestra variable.
Usamos un signo de igualdad (=) antes de la funci√≥n InputBox para asignar el valor ingresado por el usuario.
Por ejemplo:

numerador = InputBox("Escribe el numerador", "Divisi√≥n")

**¬øPor qu√© usar Input Boxes en subrutinas?**
Cuando desarrollamos subrutinas, estas no admiten argumentos como las funciones. Por tanto, el Input Box juega un papel clave pidiendo directamente al usuario los datos necesarios:

Declarar las variables necesarias para la operaci√≥n.
Solicitar los datos a trav√©s del InputBox.
Realizar operaciones y mostrar resultados utilizando estas entradas.
Ejemplo de una subrutina para divisiones:

Public Sub DivS()
    Dim num As Integer
    Dim den As Integer
    
    num = InputBox("Ingrese el numerador", "Divisi√≥n")
    den = InputBox("Ingrese el denominador", "Divisi√≥n")
    
    MessageBox.Show "El resultado de la divisi√≥n es " & (num / den), "Divisi√≥n"
    
End Sub

Promoviendo la interacci√≥n: Beneficios de las ventanas emergentes
El uso de ventanas emergentes, como el Input Box, no solo personaliza la experiencia del usuario, sino que tambi√©n asegura que las operaciones se basen en datos relevantes y espec√≠ficos introducidos por el mismo. Esta t√©cnica es particularmente beneficiosa en:

Automatizaci√≥n de tareas: Cuando se requiere repetir una acci√≥n con distintos datos, reduciendo as√≠ el margen de error.
Acercamiento educativo: En contextos acad√©micos, donde se necesita la entrada del usuario para operaciones matem√°ticas, cient√≠ficas o administrativas.

**PRACTICA**
```VB
Public Function Divf() As Double

    Dim a
    Dim num As Integer
    Dim den As Integer
    
    num = InputBox("Ingrese el numerador", "Divisi√≥n")
    den = InputBox("Ingrese el denominador", "Divisi√≥n")
    Divf = num / den
    a = MsgBox("El resultado de la divisi√≥n es " & Divf, "Divisi√≥n")
    
End Function


Public Sub DivS()
    Dim a
    Dim num As Integer
    Dim den As Integer

    num = InputBox("Ingrese el numerador", "Divisi√≥n")
    den = InputBox("Ingrese el denominador", "Divisi√≥n")
    
    a = MsgBox("El resultado de la divisi√≥n es " & num / dev, , "Divisi√≥n")
    
End Sub
```
## CLASE 12:  Uso de Select Case en Visual Basic para Condicionales

**¬øQu√© es Select Case y c√≥mo se utiliza?**
En el mundo de la programaci√≥n, ser capaz de manejar diferentes casos o escenarios es esencial. Aqu√≠ es donde el uso de Select Case se convierte en una herramienta poderosa en tus funciones y subrutinas dentro de Visual Basic. Este bloque de control permite especificar m√∫ltiples condiciones para una variable, otorg√°ndote el control de qu√© instrucciones ejecutar con base en el valor de dicha variable. Al realizar un an√°lisis exhaustivo de todos los posibles casos que pueda tomar una variable dentro de tu funci√≥n, puedes asegurar un flujo l√≥gico y sin errores en tu c√≥digo.

**¬øC√≥mo se estructura una funci√≥n con Select Case?**

Para comenzar a implementar Select Case, es necesario definir una funci√≥n que reciba argumentos y devuelva un resultado. Un ejemplo com√∫n es el uso de una funci√≥n llamada sc, que debe recibir tres n√∫meros enteros, sumarlos y determinar si la suma es negativa, cero o positiva. Este es el proceso detallado para configurarla:

Definici√≥n de la funci√≥n: Escribe Public Function sc con tres par√°metros: a, b y c.
Variable de suma: Define a trav√©s de Dim suma as Integer una variable que almacenar√° la suma de a, b y c.
Uso de Select Case: Implementa Select Case suma para evaluar el valor de la suma y escribe los diferentes cases:
Case Is < 0: Significa que la suma es negativa.
Case Is = 0: Indica que la suma resulta en cero.
Case Else: Captura los casos en que la suma es positiva, siendo exhaustivos en todos los posibles resultados.

**¬øCu√°les son las mejores pr√°cticas para utilizar Select Case?**
Utilizar Select Case adecuadamente implica seguir algunas pr√°cticas recomendadas que asegurar√°n que tu c√≥digo sea claro y eficiente:

Exhaustividad en casos: Aseg√∫rate de considerar todos los posibles valores y situaciones en los cases. Utiliza Case Else para cubrir cualquier valor que no haya sido contemplado previamente.
Comentarios claros: Incluye comentarios en el c√≥digo que expliquen cada secci√≥n de los cases, lo que resulta √∫til para el mantenimiento y comprensi√≥n del c√≥digo a largo plazo.
Validaci√≥n de datos: Antes de ingresar los datos en la funci√≥n, es importante validarlos para evitar resultados inesperados.

**¬øC√≥mo puedo probar la funci√≥n Select Case?**
Una vez que has creado tu funci√≥n, la prueba es clave para asegurarse de que todos los casos se ejecutan correctamente. Esto se puede hacer utilizando la ventana inmediata de Visual Basic:

- Prueba para valores negativos: Probar con CondicionalSC(-8, 5, 0) deber√≠a devolver "negativo".
- Prueba para suma igual a cero: Con CondicionalSC(2, -1, -1) debe regresar "cero".- 
- Prueba para valores positivos: Al usar CondicionalSC(3, 4, 5), la funci√≥n deber√≠a dar como resultado "positivo".

**PRACTICA**
```VB
'GENERACI√ìN DE CONDICIONALES Select Case'

Public Function CondicionalSC(numA As Integer, numB As Integer, numC As Integer) As String
    Dim suma As Integer
    
    suma = numA + numB + numC
    
    Select Case suma
        Case Is < 0
            CondicionalSC = "Negativo"
        Case Is = 0
            CondicionalSC = "Cero"
        Case Is > 0
            CondicionalSC = "Positivo"
        Case Else
            CondicionalSC = "Ni Idea que demonios metiste"
    End Select
End Function


Public Sub ClasificarEdad()

    Dim edad As Integer
    
    edad = InputBox("Ingresa tu edad:", "Clasificaci√≥n de Edad")
    
    Select Case edad
    
    Case 0 To 12
    
    MsgBox "Eres un ni√±o"
    
    Case 13 To 17
    
    MsgBox "Eres un adolescente"
    
    Case 18 To 59
    
    MsgBox "Eres un adulto"
    
    Case 60 To 99
    
    MsgBox "Eres un adulto mayor"
    
    Case Else
    
    MsgBox "Edad inv√°lida"
    
    End Select

End Sub

```
## CLASE 13: Condicionales IF-THEN en Visual Basic: Funciones y Ejercicios Pr√°cticos

**¬øQu√© es la instrucci√≥n if-then y c√≥mo se utiliza?**

La instrucci√≥n IF-THEN es una herramienta fundamental en la programaci√≥n que permite ejecutar acciones espec√≠ficas si se cumple una determinada condici√≥n. En esencia, se estructura como: "si ocurre esto, entonces haz aquello". Esta instrucci√≥n es clave para implementar condicionales y tomar decisiones en funci√≥n de los datos disponibles, permitiendo mayor control y flexibilidad en los programas.

En Visual Basic, por ejemplo, puedes emplear IF-THEN para decidir si el valor de un dado es par o impar. Esto se hace utilizando funciones y variables que determinan el valor y, posteriormente, eval√∫an la condici√≥n para ejecutar la acci√≥n correspondiente.

**¬øC√≥mo crear una funci√≥n para un dado en Visual Basic?**
La creaci√≥n de una funci√≥n en Visual Basic requiere definir claramente los pasos y decisiones que deseas implementar. Aqu√≠ te brindamos una gu√≠a para programar una funci√≥n que simule el lanzamiento de un dado y determine su resultado como par o impar.

Definir la funci√≥n y las variables:

Crea una funci√≥n llamada "dado" que no requiere argumentos ya que los lanzamientos de un dado son aleatorios.
Define la variable para almacenar el valor del dado, por ejemplo, usa vd como dim vd as integer.
Generar el valor aleatorio:

Visual Basic tiene una funci√≥n random para obtener un n√∫mero aleatorio entre 0 y 1.
Ajusta este valor multiplic√°ndolo por 6 y sumando 1 para que resulte en un n√∫mero entero entre 1 y 6: int(random * 6 + 1).
Implementar la condici√≥n IF-THEN:

Utiliza IF-THEN para comprobar si el valor del dado es par. Por ejemplo, comprueba si vd es igual a 2, 4 o 6 para considerarlo par: if vd = 2 or vd = 4 or vd = 6 then dado = "par".
Usa else para otros valores y considera que el dado es impar: else dado = "impar".
Probar y visualizar el resultado:

Prueba la funci√≥n en el entorno de desarrollo para verificar su correcto funcionamiento.
Usa un message box para mostrar el valor del dado.

**¬øC√≥mo optimizar las condiciones con else if?**

El uso de else if optimiza el c√≥digo al detener la evaluaci√≥n una vez que una condici√≥n se cumple, lo cual es crucial en programas complejos o con grandes vol√∫menes de datos.

Reducir evaluaci√≥n innecesaria:

Al usar solo if, cada condici√≥n se eval√∫a independientemente, lo que puede ser ineficiente. Else if asegura que no se sigan evaluando las condiciones una vez que se encuentra la correcta.
Estructurar cuidadosamente las condiciones:

Aseg√∫rate de que las condiciones est√©n bien definidas para maximizar la eficiencia y claridad del c√≥digo.
Buenas pr√°cticas:

Indentar las acciones dentro de las estructuras condicionales para mejorar la legibilidad y mantenimiento.


**PRACTICA**

```VB
'GENERACI√ìN DE CONDICIONALES IF THEN '

Public Function dado() As String

    Dim VD As Integer
    Dim a
    VD = Int((Rnd * 6) + 1)
    
    If VD = 2 Then
            dado = "Par"
        ElseIf VD = 4 Then
            dado = "Par"
        ElseIf VD = 6 Then
            dado = "Par"
        Else
            dado = "ImPar"
    End If
    a = MsgBox(VD, , "Dado")
End Function
```
## CLASE 14: Ciclos For Next en Visual Basic para Excel: Fibonacci Autom√°tico

**¬øC√≥mo se utiliza el ciclo For Next en Visual Basic?**

El ciclo For Next en Visual Basic permite ejecutar una serie de instrucciones repetidamente mientras un contador se encuentra dentro de un rango determinado. Esto es crucial cuando necesitas automatizar tareas repetitivas, como llenar m√∫ltiples celdas en Excel con valores espec√≠ficos o realizar un conteo hasta cierto n√∫mero.

**¬øQu√© es la sucesi√≥n de Fibonacci y c√≥mo se implementa con Visual Basic?**
La sucesi√≥n de Fibonacci es una serie de n√∫meros que comienza con 1, seguida por otro 1, y cada n√∫mero subsecuente es la suma de los dos anteriores. Implementar esta sucesi√≥n en Excel usando Visual Basic es una excelente manera de poner en pr√°ctica el ciclo For Next.

Definir Subrutinas y Variables:

Comienza definiendo una subrutina sin argumentos ni valores de retorno.
Establece variables, como un contador (Dim i As Integer) y el n√∫mero de t√©rminos que quieres calcular (Dim n As Integer).
Crear un Input Box:

Utiliza un Input Box para solicitar al usuario cu√°ntos t√©rminos de la sucesi√≥n desea calcular:
n = InputBox("Elementos de la sucesi√≥n", "Fibonacci")
Configurar el Documento y Asignar Valores Iniciales:

Decide desde d√≥nde comenzar√°s a vaciar la informaci√≥n en tu hoja activa, generalmente desde la celda A1.
Las primeras dos entradas deber√°n ser asignadas manualmente, ya que siempre son 1s:
Cells(1, 1) = 1
Cells(2, 1) = 1
Implementar el Ciclo For Next:

Iniciar el ciclo desde 3, puesto que los dos primeros valores est√°n definidos:
For i = 3 To n
Calcula cada elemento como la suma de los dos anteriores:
Cells(i, 1) = Cells(i - 1, 1) + Cells(i - 2, 1)
Finaliza el ciclo con Next i para pasar al siguiente t√©rmino.

**¬øC√≥mo verificar el funcionamiento correcto de la subrutina?**

Puedes ejecutar la subrutina y recibir√°s un prompt preguntando cu√°ntos t√©rminos de la sucesi√≥n deseas realizar. Ingresando, por ejemplo, 20 te permitir√° confirmar visualmente en Excel que los n√∫meros aparecen correctamente. Incluso puedes verificar manualmente sumando los dos n√∫meros anteriores y compararlos con el resultado.

**¬øCu√°ndo es √∫til utilizar ciclos For Next?**
El ciclo For Next es extremadamente valioso cuando se trata de:

Poner formato: Aplicar estilos o formatos espec√≠ficos en rangos definidos.
Manipulaci√≥n masiva de datos: Insertar, modificar o eliminar grandes cantidades de datos de manera organizada.
Automatizaci√≥n: Realizar acciones repetitivas sin intervenci√≥n manual, ahorrando tiempo y minimizando errores.

**¬øC√≥mo iniciar tu propio proyecto usando ciclos For Next?**
Te invito a practicar implementando tus propias soluciones. Piensa en actividades diarias realizadas en Excel que se podr√≠an simplificar mediante estos ciclos. Comp√°rtelas o reflexiona sobre sus beneficios en los comentarios, y sigue explorando la programaci√≥n para seguir ampliando tus habilidades.


**PRACTICA**
```VB
'sub rutina'

Public Sub Fibonacci()
    Dim i As Integer
    Dim n As Integer
    
    n = InputBox("Elementos a iterar", "Fibonacci")
    
    Sheets("Hoja1").Select
    Cells(1, 1) = 1
    Cells(2, 1) = 1
    
    For i = 3 To n
        Cells(i, 1) = Cells(i - 1, 1) + Cells(i - 2, 1)
    Next i
End Sub
```

## CLASE 15:  Ciclos Do-While en Visual Basic: Suma de Dados hasta 100


**¬øQu√© es un ciclo do-while loop y c√≥mo puedo usarlo?**
Un ciclo do-while loop es una estructura de control utilizada en programaci√≥n para repetir una serie de instrucciones mientras se cumpla una determinada condici√≥n. Este tipo de bucle resulta muy √∫til en situaciones donde se necesita ejecutar un bloque de c√≥digo al menos una vez, porque la condici√≥n se eval√∫a despu√©s de ejecutar el bloque. En este contexto, exploraremos c√≥mo usar el ciclo do-while loop en Visual Basic para resolver un problema interesante: determinar cu√°ntos tiros de un dado son necesarios para alcanzar una suma de 100 puntos.

**¬øC√≥mo defino la funci√≥n en Visual Basic?**
Antes de implementar el ciclo do-while loop, es crucial definir correctamente la funci√≥n en Visual Basic. Para ello, se utiliza public function w como punto de partida. Esta funci√≥n no toma argumentos y devuelve un n√∫mero entero, lo que representa el n√∫mero de tiros necesarios para alcanzar la suma deseada. Este enfoque inicial sienta las bases para abordar problemas complejos de manera ordenada.

**¬øQu√© variables necesito para el proceso?**
Las variables son el coraz√≥n de cualquier programa. En este caso, se identifican tres variables esenciales:

Dado: Representa el valor de cada tiro, definido como un n√∫mero entero entre 1 y 6.
Contador (i): Rastrear√° cu√°ntas veces se ha tirado el dado.
Suma (s): Almacena la suma acumulada de los resultados de los dados.
Definir estas variables adecuadamente asegura una implementaci√≥n fluida y precisa del ciclo.

**¬øC√≥mo implementar el ciclo do-while loop en Visual Basic?**
El ciclo do-while se inicia con la instrucci√≥n do while s < 100, donde s es la suma acumulada. Esta estructura permite a los programadores ejecutar bloques de c√≥digo hasta que la suma alcance o supere el valor de 100. Cada iteraci√≥n incluye un paso fundamental: sumar el resultado del dado actual a la suma total y aumentar el contador.

Una caracter√≠stica valiosa del ciclo do-while loop es su capacidad para repetir instrucciones sin necesidad de numerosos bloques de c√≥digo manual, lo que simplifica significativamente la cantidad de trabajo y reduce errores.

**¬øC√≥mo asignar valores aleatorios al dado?**
Para simular un dado, se usa la funci√≥n worksheet function.random between(1, 6), que genera un n√∫mero aleatorio entre 1 y 6. Este m√©todo se integra de manera eficiente en Visual Basic y otorga un valor aut√©ntico a cada tiro de dado. Al emplear esta funci√≥n, se garantiza que cada ronda de tiro sea √∫nica, lo que realza el car√°cter aleatorio del juego.

**¬øPor qu√© es importante devolver el resultado del contador?**
El valor final del contador indica cu√°ntas veces fue necesario lanzar el dado para alcanzar la suma de 100 puntos. Este es un aspecto cr√≠tico que se devuelve al final de la funci√≥n, y se logra a trav√©s de la instrucci√≥n dw = i. Los usuarios pueden experimentar esta funci√≥n directamente en Visual Basic, observando resultados que var√≠an din√°micamente debido a la naturaleza aleatoria de los tiros de dados.

**¬øC√≥mo probar y personalizar la funci√≥n con diferentes objetivos?**
Probar la funci√≥n en la ventana de inmediato de Visual Basic permite verificar la precisi√≥n y eficacia de la implementaci√≥n. Realiza un reto adicional: adapta el c√≥digo para que el usuario pueda elegir la suma objetivo, permitiendo un grado de personalizaci√≥n y an√°lisis m√°s profundo para distintos escenarios.

Ahora, te invitamos a que pongas a prueba este c√≥digo en tu computadora y explores otras aplicaciones de los ciclos do-while loop. ¬øC√≥mo adaptar√≠as este enfoque para otros desaf√≠os de programaci√≥n? Comparte tus experiencias y descubrimientos en los comentarios, y sigue aprendiendo y ampliando tus habilidades de codificaci√≥n.


**PRACTICA**
```VB
'sub rutina'

Public Sub Fibonacci()
    Dim i As Integer
    Dim n As Integer
    
    n = InputBox("Elementos a iterar", "Fibonacci")
    
    Sheets("Hoja1").Select
    Cells(1, 1) = 1
    Cells(2, 1) = 1
    
    For i = 3 To n
        Cells(i, 1) = Cells(i - 1, 1) + Cells(i - 2, 1)
    Next i
End Sub
```

## CLASE 16:

Una macro es una acci√≥n o un conjunto de acciones que se pueden ejecutar todas las veces que desees.
Verdadero
2.
¬øDesde cu√°l pesta√±a se puede acceder al espacio de VBA?
Desde la pesta√±a Desarrollador, que no aparece por default en Excel, sino que se debe activar.
3.
¬øCu√°l de las siguientes afirmaciones es falsa?
Cuando se hace un diagrama de flujo, es importante que cuando se pone una condici√≥n, los posibles resultados sean exhaustivos.
**Repasar**

4.
¬øCu√°l de los siguientes NO es un tipo de dato?
Text
5.
¬øCu√°l de las siguientes afirmaciones es cierta para las funciones pero no para las subrutinas?
Tiene un valor de retorno.


6.
¬øCu√°l es la sintaxis correcta de una funci√≥n?
Public/Private - Function - Nombre - (par√°metros) - as Tipo de dato

7.
Al escribir " Function [nombre] (par√°metros)" y dar enter, aparece autom√°ticamente la l√≠nea de cierre que dice ‚ÄúEnd Function‚Äù

Verdadero
8.
Al crear una subrutina es necesario agregar argumentos.
Falso

9.
¬øQu√© es Message Box?
Es una funci√≥n que muestra un mensaje en un cuadro de di√°logo.

10.
Hablando de Input Box, ¬øCu√°l de las siguientes afirmaciones es falsa?
Se escribe Input.Box

11.
¬øCu√°ndo utilizar√≠as Select Case?
Cuando se ejecuta una acci√≥n o conjunto de acciones dependiendo el caso en el que corresponda el argumento.

12.
¬øCu√°ndo utilizar√≠as If - Then?
Cuando se necesita ejecutar una acci√≥n o conjunto de acciones dependiendo de si la expresi√≥n cumple con una condici√≥n.

13.
¬øCu√°ndo utilizar√≠as Ciclos For - Next?

Cuando se busca repetir una instrucci√≥n un n√∫mero espec√≠fico de veces.

14.
¬øCu√°ndo utilizar√≠as Ciclos Do While - Loop?

Cuando se busca que un ciclo se siga repitiendo mientras que una condici√≥n se cumple.

15.  Qu√© es Message Box?
Es una funci√≥n que muestra un mensaje en un cuadro de di√°logo.

16. ¬øPara qu√© sirve la segmentaci√≥n de datos?
Crear botones interactivos para filtrar datos.

17. ¬øCu√°l es la ventaja fundamental de usar referencias din√°micas como `ventas[importe]` en lugar de rangos fijos como `F2:F50` al realizar c√°lculos en Excel?
- Las referencias din√°micas hacen que las f√≥rmulas sean m√°s cortas y f√°ciles de leer.
**REPASAR** 


18. Si un informe de Excel es demasiado ancho para caber en una p√°gina al imprimirlo en orientaci√≥n vertical, ¬øcu√°l ser√≠a la combinaci√≥n de ajustes m√°s eficaz para presentarlo correctamente sin perder informaci√≥n?
- Utilizar la vista 'Ver saltos de p√°gina' para arrastrar manualmente el l√≠mite de la p√°gina hacia la derecha.
**REPASAR** 

19. Camila quiere crear una alerta que identifique cualquier gasto clasificado como 'prescindible' O como 'imprevisto' para marcarlo como 'Recortar gasto'. Si ninguna de estas dos condiciones se cumple, debe marcarse como 'Ok'. ¬øQu√© f√≥rmula anidada debe usar para lograr esto correctamente?
- SI(Y(A2="prescindible"; B2="imprevisto"); "Recortar gasto"; "Ok")
**REPASAR** 


20. Al usar la funci√≥n √çNDICE, ¬øpor qu√© es crucial que la matriz de datos seleccionada excluya los encabezados de fila y columna?

Porque los encabezados suelen ser texto y la funci√≥n √çNDICE solo puede devolver valores num√©ricos.

**REPASAR** 
